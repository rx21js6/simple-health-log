<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:b="http://bootsfaces.net/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
<h:head>
    <title><h:outputText value="#{msg['common.title']}" /></title>

    <ui:fragment rendered="#{loginInfo.userInfo == null}">
        <f:metadata>
            <f:viewAction action="#{dailyRecordController.init()}" />
        </f:metadata>
    </ui:fragment>
    <ui:fragment rendered="#{loginInfo.userInfo != null}">
        <f:metadata>
            <f:viewAction action="#{dailyRecordController.loadRecord()}" />
            <f:viewAction action="#{maintUserController.init()}" />
        </f:metadata>
    </ui:fragment>
</h:head>
<h:body>
    <b:container>
        <b:row>
            <b:column>
                <h1>
                    <h:outputText value="#{msg['common.title']}" />
                </h1>
            </b:column>
        </b:row>
        <b:row>
            <b:column>
                <b:messages></b:messages>
            </b:column>
        </b:row>
        <b:row>
            <b:column>
                <h:outputText value="ログインしていません。"
                    rendered="#{loginInfo.userInfo == null}" />
                <h:outputText value="#{loginInfo.userInfo.name}さんようこそ"
                    rendered="#{loginInfo.userInfo != null}" />
            </b:column>
        </b:row>

        <b:form inline="true">
            <b:row rendered="#{loginInfo.userInfo != null}">
                <b:column>
                    <b:commandButton action="#{loginController.logout()}">ログアウト</b:commandButton>
                </b:column>
            </b:row>
        </b:form>

        <!-- ログイン -->
        <ui:fragment rendered="#{loginInfo.userInfo == null}">
            <b:form inline="true">
                <b:row>
                    <b:column id="loginValues">
                        <b:panelGrid columns="1" cellpadding="5">
                            <b:inputText value="#{loginController.loginForm.loginId}"
                                label="Login ID:" labelStyle="width:150px;" maxlength="10" />
                            <b:inputSecret value="#{loginController.loginForm.password}"
                                label="Password:" labelStyle="width:150px;" maxlength="32" />
                            <b:selectBooleanCheckbox
                                value="#{loginController.loginForm.keepLogin}" label="ログイン状態を保持"
                                labelStyle="width:150px;" />
                        </b:panelGrid>
                    </b:column>
                    <b:column>
                        <b:commandButton value="ログイン" action="#{loginController.login()}"
                            look="primary" size="lg" />
                    </b:column>
                </b:row>
            </b:form>
            <b:form>
                <b:row>
                    <b:column>
                        <b:commandButton value="パスワード忘れた"
                            action="#{passwordResetController.showPage()}" />
                    </b:column>
                </b:row>
            </b:form>
        </ui:fragment>

        <!-- 入力 -->
        <ui:fragment rendered="#{loginInfo.userInfo != null}">

            <b:row>
                <b:column>
                    <h4>
                        <h:outputText value="#{dailyRecordController.today}" />
                    </h4>
                </b:column>
            </b:row>
            <b:form>
                <b:row>
                    <b:column>
                        <b:commandButton value="月次" icon="list"
                            action="#{monthlyRecordListController.showMonthlyList()}">
                            <f:setPropertyActionListener
                                value="#{dailyRecordController.today}"
                                target="#{monthlyRecordListController.today}" />
                        </b:commandButton>
                        <b:commandButton value="全員" icon="list"
                            action="#{dailyRecordListController.showDailyList()}"
                            rendered="#{loginInfo.userInfo.roleId == 0}">
                            <f:setPropertyActionListener
                                value="#{dailyRecordController.today}"
                                target="#{dailyRecordListController.today}" />
                        </b:commandButton>
                        <b:commandButton action="#{maintUserController.showList()}"
                            value="利用者" icon="user"
                            rendered="#{loginInfo.userInfo.roleId == 0}" />
                    </b:column>
                    <b:column>
                        <b:commandButton value="前日" icon="chevron-left"
                            action="#{dailyRecordController.loadYesterday()}" />
                        <b:commandButton value="当日" icon="chevron-up"
                            action="#{dailyRecordController.loadToday()}" />
                        <b:commandButton value="翌日" icon="chevron-right"
                            action="#{dailyRecordController.loadTomorrow()}" />
                    </b:column>
                </b:row>
            </b:form>

            <b:row>
                <b:column>
                    <h3>体調</h3>
                </b:column>
            </b:row>

            <b:form inline="true">
                <b:row>
                    <b:column>
                        <h4>朝</h4>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column id="dailyRecordValuesMorning">
                        <b:panelGrid columns="3">
                            <b:inputText type="time"
                                value="#{dailyRecordInputModel.physicalCondition.awakeTime}"
                                converter="timeConverter" label="起床時刻:"
                                labelStyle="width:100px;">
                            </b:inputText>
                            <b:inputText type="number" mask="99.9" p:step="0.1"
                                value="#{dailyRecordInputModel.physicalCondition.bodyTemperatureMorning}"
                                label="体温:" labelStyle="width:100px;" maxlength="4">
                                <f:converter converterId="javax.faces.BigDecimal" />
                            </b:inputText>
                            <b:message for="@previous" />

                            <b:inputText type="number" mask="9{1,2}"
                                value="#{dailyRecordInputModel.physicalCondition.oxygenSaturationMorning}"
                                label="酸素飽和濃度:" labelStyle="width:100px;" maxlength="3">
                                <f:converter converterId="javax.faces.Integer" />
                            </b:inputText>
                            <b:message for="@previous" />
                        </b:panelGrid>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <h4>夜</h4>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column id="dailyRecordValuesEvening">
                        <b:panelGrid columns="3">
                            <b:inputText type="time"
                                value="#{dailyRecordInputModel.physicalCondition.bedTime}"
                                converter="timeConverter" label="就寝時刻:"
                                labelStyle="width:100px;">
                            </b:inputText>
                            <b:inputText type="number" mask="99.9" p:step="0.1"
                                value="#{dailyRecordInputModel.physicalCondition.bodyTemperatureEvening}"
                                label="体温:" labelStyle="width:100px;" maxlength="4">
                                <f:converter converterId="javax.faces.BigDecimal" />
                            </b:inputText>
                            <b:message for="@previous" />

                            <b:inputText type="number" mask="9{1,2}"
                                value="#{dailyRecordInputModel.physicalCondition.oxygenSaturationEvening}"
                                label="酸素飽和濃度:" labelStyle="width:100px;" maxlength="3">
                                <f:converter converterId="javax.faces.Integer" />
                                <b:message for="@previous" />

                            </b:inputText>
                        </b:panelGrid>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <h4>メモ</h4>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <b:inputTextarea
                            value="#{dailyRecordInputModel.physicalCondition.conditionNote}"
                            label="特記事項等" labelStyle="width:100px;" maxlength="100">
                            <b:message for="@previous" />
                        </b:inputTextarea>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <b:panelGrid columns="6">
                            <b:commandButton value="#{msg['common.button.register']}"
                                look="primary" size="lg"
                                action="#{dailyRecordController.register()}" />
                        </b:panelGrid>

                    </b:column>
                </b:row>
            </b:form>

        </ui:fragment>

    </b:container>
</h:body>
</html>