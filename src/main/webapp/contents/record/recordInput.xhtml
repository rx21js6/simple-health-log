<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:b="http://bootsfaces.net/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
<h:head>
    <title><h:outputText value="#{msg['common.title']}" /></title>

    <ui:fragment rendered="#{loginInfo.userInfo == null}">
        <f:metadata>
            <f:viewAction action="#{dailyRecordController.init()}" />
        </f:metadata>
    </ui:fragment>
    <ui:fragment rendered="#{loginInfo.userInfo != null}">
        <f:metadata>
            <f:viewAction action="#{dailyRecordController.loadRecord()}" />
            <f:viewAction action="#{maintUserController.init()}" />
        </f:metadata>
    </ui:fragment>
</h:head>
<h:body>
    <b:container>
        <b:row>
            <b:column>
                <h1>
                    <h:outputText value="#{msg['common.title']}" />
                </h1>
            </b:column>
        </b:row>
        <b:row>
            <b:column>
                <b:messages></b:messages>
            </b:column>
        </b:row>
        <b:row>
            <b:column>
                <h:outputText
                    value="#{msg['contents.record.recordInput.msg.notLoggedIn']}"
                    rendered="#{loginInfo.userInfo == null}" />
                <h:outputText
                    value="#{loginInfo.userInfo.name} #{msg['contents.record.recordInput.label.welcome']}"
                    rendered="#{loginInfo.userInfo != null}" />
            </b:column>
        </b:row>

        <b:form inline="true">
            <b:row rendered="#{loginInfo.userInfo != null}">
                <b:column>
                    <b:commandButton action="#{loginController.logout()}">
                        <h:outputText value="#{msg['common.label.screen.logout']}" />
                    </b:commandButton>
                </b:column>
            </b:row>
        </b:form>

        <!-- ログイン -->
        <ui:fragment rendered="#{loginInfo.userInfo == null}">
            <b:form inline="true">
                <b:row>
                    <b:column id="loginValues">
                        <b:panelGrid columns="1" cellpadding="5">
                            <b:inputText value="#{loginFormModel.loginForm.loginId}"
                                label="#{msg['common.label.loginId']}" labelStyle="width:150px;"
                                maxlength="10" />
                            <b:inputSecret value="#{loginFormModel.loginForm.password}"
                                label="#{msg['common.label.password']}"
                                labelStyle="width:150px;" maxlength="32" />
                            <b:selectBooleanCheckbox
                                value="#{loginFormModel.loginForm.loggingPersistent}"
                                label="#{msg['login.keepLoggedIn']}" labelStyle="width:150px;" />
                        </b:panelGrid>
                    </b:column>
                    <b:column>
                        <b:commandButton value="#{msg['common.button.login']}"
                            action="#{dailyRecordController.login()}" look="primary" size="lg" />
                    </b:column>
                </b:row>
            </b:form>
            <b:form>
                <b:row>
                    <b:column>
                        <b:commandButton value="#{msg['login.forgottenPassword']}"
                            action="#{passwordResetController.showPage()}" />
                    </b:column>
                </b:row>
            </b:form>
        </ui:fragment>

        <!-- 入力 -->
        <ui:fragment rendered="#{loginInfo.userInfo != null}">

            <b:row>
                <b:column>
                    <h4>
                        <h:outputText value="#{dailyRecordController.today}" />
                    </h4>
                </b:column>
            </b:row>
            <b:form inline="true">
                <b:row>
                    <b:column>
                        <b:commandButton id="monthlyListButton"
                            value="#{msg['common.label.monthly']}" icon="list"
                            action="#{dailyRecordController.showMonthlyList(false)}">
                            <f:setPropertyActionListener
                                value="#{dailyRecordController.today}"
                                target="#{monthlyRecordListController.today}" />
                        </b:commandButton>
                        <b:commandButton id="dailyListButton"
                            value="#{msg['common.label.allUser']}" icon="list"
                            action="#{dailyRecordController.showDailyList(false)}"
                            rendered="#{loginInfo.userInfo.roleId == 0}">
                            <f:setPropertyActionListener
                                value="#{dailyRecordController.today}"
                                target="#{dailyRecordListController.today}" />
                        </b:commandButton>
                        <b:commandButton id="listsButton"
                            action="#{maintUserController.showList()}"
                            value="#{msg['common.label.user']}" icon="user"
                            rendered="#{loginInfo.userInfo.roleId == 0}" />
                    </b:column>
                    <b:column>
                        <b:commandButton id="yesterdayButton"
                            value="#{msg['common.label.yesterday']}" icon="chevron-left"
                            action="#{dailyRecordController.loadYesterday(false)}" />
                        <b:commandButton id="todayButton"
                            value="#{msg['common.label.today']}" icon="chevron-up"
                            action="#{dailyRecordController.loadToday(false)}" />
                        <b:commandButton id="tomorrowButton"
                            value="#{msg['common.label.tomorrow']}" icon="chevron-right"
                            action="#{dailyRecordController.loadTomorrow(false)}" />
                    </b:column>
                </b:row>

                <b:row>
                    <b:column>
                        <h3>
                            <h:outputText
                                value="#{msg['contents.record.recordInput.label.condition']}" />
                        </h3>
                    </b:column>
                </b:row>


                <b:row>
                    <b:column>
                        <h4>
                            <h:outputText
                                value="#{msg['contents.record.recordInput.label.morning']}" />
                        </h4>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column id="dailyRecordValuesMorning">
                        <b:panelGrid columns="3">
                            <b:inputText type="time"
                                value="#{dailyRecordInputModel.physicalCondition.awakeTime}"
                                converter="timeConverter"
                                label="#{msg['contents.record.recordInput.label.awakeTime']}"
                                labelStyle="width:100px;">
                            </b:inputText>
                            <b:inputText type="number" mask="99.9" p:step="0.1"
                                value="#{dailyRecordInputModel.physicalCondition.bodyTemperatureMorning}"
                                label="#{msg['contents.record.recordInput.label.bodyTemperature']}"
                                labelStyle="width:100px;" maxlength="4">
                                <f:converter converterId="javax.faces.BigDecimal" />
                            </b:inputText>
                            <b:message for="@previous" />

                            <b:inputText type="number" mask="9{1,2}"
                                value="#{dailyRecordInputModel.physicalCondition.oxygenSaturationMorning}"
                                label="#{msg['contents.record.recordInput.label.oxygenSaturation']}"
                                labelStyle="width:100px;" maxlength="3">
                                <f:converter converterId="javax.faces.Integer" />
                            </b:inputText>
                            <b:message for="@previous" />
                        </b:panelGrid>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <h4>
                            <h:outputText
                                value="#{msg['contents.record.recordInput.label.evening']}" />
                        </h4>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column id="dailyRecordValuesEvening">
                        <b:panelGrid columns="3">
                            <b:inputText type="time"
                                value="#{dailyRecordInputModel.physicalCondition.bedTime}"
                                converter="timeConverter"
                                label="#{msg['contents.record.recordInput.label.bedTime']}"
                                labelStyle="width:100px;">
                            </b:inputText>
                            <b:inputText type="number" mask="99.9" p:step="0.1"
                                value="#{dailyRecordInputModel.physicalCondition.bodyTemperatureEvening}"
                                label="#{msg['contents.record.recordInput.label.bodyTemperature']}"
                                labelStyle="width:100px;" maxlength="4">
                                <f:converter converterId="javax.faces.BigDecimal" />
                            </b:inputText>
                            <b:message for="@previous" />

                            <b:inputText type="number" mask="9{1,2}"
                                value="#{dailyRecordInputModel.physicalCondition.oxygenSaturationEvening}"
                                label="#{msg['contents.record.recordInput.label.oxygenSaturation']}"
                                labelStyle="width:100px;" maxlength="3">
                                <f:converter converterId="javax.faces.Integer" />
                                <b:message for="@previous" />

                            </b:inputText>
                        </b:panelGrid>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <h4>
                            <h:outputText
                                value="#{msg['contents.record.recordInput.label.note']}" />
                        </h4>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <b:inputTextarea
                            value="#{dailyRecordInputModel.physicalCondition.conditionNote}"
                            label="#{msg['contents.record.recordInput.label.conditionNote']}"
                            labelStyle="width:100px;" maxlength="100">
                            <b:message for="@previous" />
                        </b:inputTextarea>
                    </b:column>
                </b:row>
                <b:row>
                    <b:column>
                        <b:panelGrid columns="6">
                            <b:commandButton id="registrationButton"
                                value="#{msg['common.button.register']}" look="primary"
                                size="lg" action="#{dailyRecordController.register()}" />
                        </b:panelGrid>
                        <b:defaultCommand target="registrationButton" />
                    </b:column>
                </b:row>
            </b:form>
            <b:row>
                <h:form id="modalForm">
                    <ui:fragment rendered="#{commonConfirmModalBean.visible}">
                        <ui:insert>
                            <ui:include src="/contents/common/commonConfirmModal.jsf" />
                        </ui:insert>
                    </ui:fragment>
                </h:form>
            </b:row>
        </ui:fragment>

    </b:container>
</h:body>
</html>